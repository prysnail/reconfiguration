# 代码重构
代码重构示例，从糟糕代码重构到完美过程，记录过程中思路和思考

逐步改进代码。


## 说明
阅读说明：
1. `com.prynsail.original`:尚未重构的源代码
2. `com.prysnail.preliminary`:自我思考重构后的代码
3. `com.prysnail.reconfiguration`:参考资料进行重构后的代码 

其中`com.prysnail.original`包下面的代码都是尚未重构的源代码，代码中的注释等都是
源代码中存在的注释，非新增。新增注释会在注释前统一加 `by prysnail:`以区分。

示例中代码可能是系统中的部分代码，专注于重构便好，为方便理解，每个module下都有
**README**文件说明

## 示例1说明

示例为影片出租程序，计算每一位顾客的消费金额并打印详单。

操作者告诉程序：顾客租赁了哪些影片、租期多长，程序根据租赁时间和影片类型算出费用。

影片分三类：普通片、儿童片、新片。

除计算费用，还要为常客计算积分，积分会根据租片种类是否为新片而有不同。

## 重构过程

1. 函数重构，将长函数切分成小函数(找出函数内局部变量和参数，任何不会被修改
的变量都可以被当成参数传入新函数，被修改变量可以当做返回值。)
2. 命名规范(变量名称是代码清晰的关键；唯有写出人类容易理解的代码，才是优秀的程序员。)
3. 函数迁移(函数应该放在它所使用的数据的所属对象内。)
4. 函数重构，抽离积分计算逻辑，并将拆离函数迁移。
5. 去除临时变量(函数抽离之后会剩余无效的临时变量，函数重构之后去除不必要的变量。)
6. 函数迁移(之所以将租期传给Movie，而不是将影片类型传给Rental对象，是因为系统可能发生的变化
是加入新影片类型，这种变化带有不稳定倾向，尽量控制它造成的影响。)